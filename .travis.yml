language: node_js
dist: trusty
sudo: required

branches:
  except:
    - /^v[0-9]/

node_js:
  - 7

cache:
  apt: true
  yarn: true
  ccache: true

addons:
  apt:
    sources: ['ubuntu-toolchain-r-test']
    packages: ['testing', 'gcc', 'build-essential', 'git', 'cmake', 'pkg-config', 'libbz2-dev', 'libstxxl-dev', 'libstxxl1v5', 'libxml2-dev', 'libzip-dev', 'libboost-all-dev', 'lua5.2', 'liblua5.2-dev', 'libtbb-de']

env: CCOMPILER='gcc-6' CXXCOMPILER='g++-6'

before_install:
  - yarn global add greenkeeper-lockfile@1

install:
  - yarn

before_script:
  - greenkeeper-lockfile-update

script:
  - make test

after_script:
  - greenkeeper-lockfile-upload